<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gd.sakila.mapper.FilmMapper">
	
	<!-- Map : filmId(in입력), storeId(in입력), filmCount(out.출력) -->
	<select id="selectFilmInStock" parameterType="java.util.Map" resultType="int" statementType="CALLABLE"> <!-- 프로시저 부를때 {}사용 --> <!-- statementType="CALLABLE"이것도 써야함. -->
		{ 
			call film_in_stock(
				#{filmId},
				#{storeId},
				#{filmCount, mode=OUT, jdbcType=DECIMAL, javaType=Integer} <!-- 출력은 붙여줘야함 -->
			)
		}
	</select>
	
	
	
	<!-- FilmList -->
	<select id="selectFilmList" parameterType="com.gd.sakila.vo.PageParam" resultType="com.gd.sakila.vo.FilmView">
		SELECT 
			FID,
			title,
			description,
			category,
			price,
			length,
			rating,
			actors
		FROM
			nicer_but_slower_film_list
		<where>
			<if test="searchWord != null "> <!-- null이 아닐때 -->
				title LIKE CONCAT('%', #{searchWord}, '%') OR actors LIKE CONCAT('%', #{searchWord}, '%')
			</if>	
		</where>
		ORDER BY FID ASC
		LIMIT #{beginRow}, #{rowPerPage}			
	</select>
	
	
	
	<!-- FilmTotal () , selectList보여줄 때 total도 필요함 -->
	<select id="selectFilmTotal" parameterType="String" resultType="int">
		SELECT 
			COUNT(*)
		FROM 
			nicer_but_slower_film_list
		<where>
			<if test="searchWord != null "> <!-- null이 아닐때 -->
				title LIKE CONCAT('%', #{searchWord}, '%')
			</if>	
		</where>	
	</select>
	
</mapper>